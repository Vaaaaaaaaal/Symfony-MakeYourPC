{% extends 'base.html.twig' %}

{% block title %}Paiement - MakeYourPC{% endblock %}

{% block body %}
    <div class="container">
        <h1 class="my-4">Paiement sécurisé</h1>

        <div class="payment-container">
            <form method="POST" class="payment-form" id="payment-form">
                <div class="card-element">
                    <div class="form-group">
                        <label for="card-number">Numéro de carte</label>
                        <input type="text" id="card-number" class="form-control" placeholder="1234 5678 9012 3456" maxlength="19">
                    </div>

                    <div class="form-row">
                        <div class="form-group col-md-6">
                            <label for="card-expiry">Date d'expiration</label>
                            <input type="text" id="card-expiry" class="form-control" placeholder="MM/AA" maxlength="5">
                        </div>
                        <div class="form-group col-md-6">
                            <label for="card-cvc">CVC</label>
                            <input type="text" id="card-cvc" class="form-control" placeholder="123" maxlength="3">
                        </div>
                    </div>

                    <button type="submit" class="btn-payment">
                        Payer maintenant
                        <i data-lucide="credit-card"></i>
                    </button>
                </div>
            </form>
        </div>
    </div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('payment-form');
            const cardNumber = document.getElementById('card-number');
            const cardExpiry = document.getElementById('card-expiry');
            const cardCvc = document.getElementById('card-cvc');

            // Formater le numéro de carte
            cardNumber.addEventListener('input', function(e) {
                let value = e.target.value.replace(/\s/g, '');
                value = value.replace(/(\d{4})/g, '$1 ').trim();
                e.target.value = value;
            });

            // Formater la date d'expiration
            cardExpiry.addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                if (value.length >= 2) {
                    value = value.slice(0, 2) + '/' + value.slice(2);
                }
                e.target.value = value;
            });

            // Limiter le CVC à 3 chiffres
            cardCvc.addEventListener('input', function(e) {
                e.target.value = e.target.value.replace(/\D/g, '').slice(0, 3);
            });

            form.addEventListener('submit', function(e) {
                e.preventDefault();
                const submitButton = form.querySelector('button[type="submit"]');
                submitButton.disabled = true;
                submitButton.innerHTML = 'Traitement en cours...';
                
                // Simuler un délai de traitement
                setTimeout(() => {
                    form.submit();
                }, 1500);
            });
        });
    </script>
{% endblock %} 